config:
  name: Admin Negative
  base_url: "${ENV(BASE_URL)}"
  tags: [admin, negative]
steps:
  - name: login
    request:
      method: POST
      url: /api/v1/auth/login
      json:
        username: "${ENV(USER_USERNAME)}"
        password: "${ENV(USER_PASSWORD)}"
    extract:
      token: body.access_token
    validate:
      - [status_code, eq, 200]

  - name: create category forbidden
    variables:
      authz: "Bearer ${token}"
    request:
      method: POST
      url: /api/v1/categories/
      headers:
        Authorization: "${authz}"
      json:
        name: "cat-${short_uid(8)}"
        description: "tmp"
    validate:
      - [status_code, eq, 403]
      - [body.message, contains, "Not enough permissions"]
