config:
  name: Admin Negative
  base_url: ${ENV(BASE_URL)}
  tags: [admin, negative]
  variables:
    user_username: ${ENV(USER_USERNAME)}
    user_password: ${ENV(USER_PASSWORD)}
steps:
  - name: login
    request:
      method: POST
      url: /api/v1/auth/login
      json:
        username: $user_username
        password: $user_password
    extract:
      token: $.data.access_token
    validate:
      - eq: [status_code, 200]

  - name: create category forbidden
    variables:
      authz: Bearer $token
    request:
      method: POST
      url: /api/v1/categories/
      headers:
        Authorization: $authz
      json:
        name: cat-${short_uid(8)}
        description: "tmp"
    validate:
      - eq: [status_code, 403]
      - contains: [$.message, "Not enough permissions"]
